"use strict";var C=Object.defineProperty;var a=(e,t)=>C(e,"name",{value:t,configurable:!0});var J=require("./get-pipe-path-BoR10qr8.cjs"),d=require("node:module"),p=require("node:path"),M=require("node:url"),y=require("get-tsconfig"),I=require("node:fs"),j=require("./index-CoHsQGpm.cjs"),w=require("./client-D6NvIMSC.cjs");const g=Object.create(null);g[".js"]=[".ts",".tsx",".js",".jsx"],g[".jsx"]=[".tsx",".ts",".jsx",".js"],g[".cjs"]=[".cts"],g[".mjs"]=[".mts"];const S=a(e=>{const[t,s]=e.split("?"),n=p.extname(t),r=g[n];if(!r)return;const o=t.slice(0,-n.length);return r.map(c=>o+c+(s?`?${s}`:""))},"mapTsExtensions"),Q=a(e=>{const t=e.indexOf(":");if(t!==-1)return e.slice(0,t)},"getScheme"),T=a(e=>e[0]==="."&&(e[1]==="/"||e[1]==="."||e[2]==="/"),"isRelativePath"),k=a(e=>T(e)||p.isAbsolute(e),"isUnixPath"),B=a(e=>{if(k(e))return!0;const t=Q(e);return t&&t!=="node"},"requestAcceptsQuery"),R="file://",U=/\.([cm]?ts|[tj]sx)($|\?)/,z=/\.json($|\?)/,G=/\/(?:$|\?)/,H=/^(?:@[^/]+\/)?[^/]+$/;exports.fileMatcher=void 0,exports.tsconfigPathsMatcher=void 0,exports.allowJs=!1;const L=a(e=>{let t=null;if(e){const s=p.resolve(e);t={path:s,config:y.parseTsconfig(s)}}else{try{t=y.getTsconfig()}catch{}if(!t)return}exports.fileMatcher=y.createFilesMatcher(t),exports.tsconfigPathsMatcher=y.createPathsMatcher(t),exports.allowJs=t?.config.compilerOptions?.allowJs??!1},"loadTsconfig"),E=a(e=>Array.from(e).length>0?`?${e.toString()}`:"","urlSearchParamsStringify"),D=[".ts",".tsx",".jsx"],$=a((e,...t)=>{for(const s of D)try{return t[0]+=s,e(...t)}catch{}},"tryExtensions"),X=a(e=>(t,...s)=>{try{return e(t,...s)}catch(n){const r=n;if(r.code==="MODULE_NOT_FOUND"){const o=$(e,t,...s)||$(e,`${t}${p.sep}index`,...s);if(o)return o}throw r}},"createImplicitResolver"),K=`${p.sep}node_modules${p.sep}`,F=a(e=>{if(!e.startsWith("data:text/javascript,"))return;const t=e.indexOf("?");if(t===-1)return;const n=new URLSearchParams(e.slice(t+1)).get("filePath");if(n)return n},"getOriginalFilePath"),N=a(e=>{const t=F(e);return t&&(d._cache[t]=d._cache[e],delete d._cache[e],e=t),e},"interopCjsExports"),b=a((e,t,s)=>{if(!(s?.filename&&U.test(s.filename))&&!exports.allowJs)return;const n=S(t);if(n)for(const r of n)try{return e(r)}catch(o){const{code:c}=o;if(c!=="MODULE_NOT_FOUND"&&c!=="ERR_PACKAGE_PATH_NOT_EXPORTED")throw o}},"resolveTsFilename"),q=a((e,t,s)=>{if(e.startsWith(R)&&(e=M.fileURLToPath(e)),exports.tsconfigPathsMatcher&&!T(e)&&!t?.filename?.includes(K)){const r=exports.tsconfigPathsMatcher(e);for(const o of r){const c=b(s,o,t);if(c)return c;try{return s(o)}catch{}}}const n=b(s,e,t);if(n)return n;try{return s(e)}catch(r){const o=r;if(o.code==="MODULE_NOT_FOUND"&&typeof o.path=="string"&&o.path.endsWith(`${p.sep}package.json`)){const c=o.message.match(/^Cannot find module '([^']+)'$/);if(c){const m=c[1],l=b(s,m,t);if(l)return l}const i=o.message.match(/^Cannot find module '([^']+)'. Please verify that the package.json has a valid "main" entry$/);if(i){const m=i[1],l=b(s,m,t);if(l)return l}}throw o}},"resolveRequest"),V=a((e,t)=>(t&&(e=X(e)),(s,n,r,o)=>{const c=a(h=>e(h,n,r,o),"resolve");if(s=N(s),n?.filename){const h=F(n.filename);h&&(n.filename=h.split("?")[0])}const i=s.split("?"),m=new URLSearchParams(i[1]);if(n?.filename){const P=new URLSearchParams(n.filename.split("?")[1]).get("namespace");P&&m.append("namespace",P)}if((m.get("namespace")??void 0)!==t)return c(s);let l=q(i[0],n,c);return p.isAbsolute(l)&&!l.endsWith(".json")&&!l.endsWith(".node")&&(l+=E(m)),l}),"createResolveFilename"),Y=`
//# sourceMappingURL=data:application/json;base64,`,A=a(()=>process.sourceMapsEnabled??!0,"shouldApplySourceMap"),v=a(({code:e,map:t})=>e+Y+Buffer.from(JSON.stringify(t),"utf8").toString("base64"),"inlineSourceMap"),Z=[".cts",".mts",".ts",".tsx",".jsx"],ee=[".js",".cjs",".mjs"],te=a(e=>{const t=Object.create(Object.getPrototypeOf(e)),s=Object.getOwnPropertyDescriptors(e);for(const n in s)Object.hasOwn(s,n)&&Object.defineProperty(t,n,s[n]);return t},"cloneExtensions"),O=a((e,t,s,n)=>{const r=Object.getOwnPropertyDescriptor(e,t);r?.set?e[t]=s:(!r||r.configurable)&&Object.defineProperty(e,t,{value:s,enumerable:r?.enumerable||n?.enumerable,writable:n?.writable??(r?r.writable:!0),configurable:n?.configurable??(r?r.configurable:!0)})},"safeSet"),se=a((e,t)=>{const s=te(e),n=s[".js"],r=a((o,c)=>{const[i,m]=c.split("?");if((new URLSearchParams(m).get("namespace")??void 0)!==t)return n(o,i);w.parent?.send&&w.parent.send({type:"dependency",path:i});const h=Z.some(f=>i.endsWith(f)),P=ee.some(f=>i.endsWith(f));if(!h&&!P)return n(o,i);let u=I.readFileSync(i,"utf8");if(i.endsWith(".cjs")){const f=j.transformDynamicImport(c,u);f&&(u=A()?v(f):f.code)}else if(h||j.isESM(u)){const f=j.transformSync(u,c,{tsconfigRaw:exports.fileMatcher?.(i)});u=A()?v(f):f.code}o._compile(u,i)},"transformer");O(s,".js",r);for(const o of D)O(s,o,r,{enumerable:!t,writable:!0,configurable:!0});return O(s,".mjs",r,{writable:!0,configurable:!0}),s},"createExtensions"),W=a((e,t)=>{if(!t)throw new Error("The current file path (__filename or import.meta.url) must be provided in the second argument of tsx.require()");return(typeof t=="string"&&t.startsWith("file://")||t instanceof URL)&&(t=M.fileURLToPath(t)),p.resolve(p.dirname(t),e)},"resolveContext"),ne=a(e=>{const{sourceMapsEnabled:t}=process,{_extensions:s,_resolveFilename:n}=d;L(process.env.TSX_TSCONFIG_PATH),process.setSourceMapsEnabled(!0);const r=V(n,e?.namespace);d._resolveFilename=r;const o=se(d._extensions,e?.namespace);d._extensions=o;const c=a(()=>{t===!1&&process.setSourceMapsEnabled(!1),d._extensions=s,d._resolveFilename=n},"unregister");if(e?.namespace){const i=a((l,h)=>{const P=W(l,h),[u,f]=P.split("?"),x=new URLSearchParams(f);return e.namespace&&x.set("namespace",e.namespace),J.require(u+E(x))},"scopedRequire");c.require=i;const m=a((l,h,P)=>{const u=W(l,h),[f,x]=u.split("?"),_=new URLSearchParams(x);return e.namespace&&_.set("namespace",e.namespace),r(f+E(_),module,!1,P)},"scopedResolve");c.resolve=m,c.unregister=c}return c},"register");exports.fileUrlPrefix=R,exports.inlineSourceMap=v,exports.interopCjsExports=N,exports.isBarePackageName=H,exports.isDirectoryPattern=G,exports.isJsonPattern=z,exports.loadTsconfig=L,exports.mapTsExtensions=S,exports.register=ne,exports.requestAcceptsQuery=B,exports.tsExtensionsPattern=U;
