var I=Object.defineProperty;var a=(e,s)=>I(e,"name",{value:s,configurable:!0});import{r as J}from"./get-pipe-path-BHW2eJdv.mjs";import d from"node:module";import u from"node:path";import{fileURLToPath as T}from"node:url";import{parseTsconfig as Q,getTsconfig as k,createFilesMatcher as z,createPathsMatcher as B}from"get-tsconfig";import G from"node:fs";import{b as H,i as X,a as K}from"./index-BQiEz0On.mjs";import{p as v}from"./client-BQVF1NaW.mjs";const x=Object.create(null);x[".js"]=[".ts",".tsx",".js",".jsx"],x[".jsx"]=[".tsx",".ts",".jsx",".js"],x[".cjs"]=[".cts"],x[".mjs"]=[".mts"];const M=a(e=>{const[s,t]=e.split("?"),n=u.extname(s),r=x[n];if(!r)return;const o=s.slice(0,-n.length);return r.map(c=>o+c+(t?`?${t}`:""))},"mapTsExtensions"),V=a(e=>{const s=e.indexOf(":");if(s!==-1)return e.slice(0,s)},"getScheme"),R=a(e=>e[0]==="."&&(e[1]==="/"||e[1]==="."||e[2]==="/"),"isRelativePath"),Y=a(e=>R(e)||u.isAbsolute(e),"isUnixPath"),Z=a(e=>{if(Y(e))return!0;const s=V(e);return s&&s!=="node"},"requestAcceptsQuery"),U="file://",L=/\.([cm]?ts|[tj]sx)($|\?)/,q=/\.json($|\?)/,ee=/\/(?:$|\?)/,se=/^(?:@[^/]+\/)?[^/]+$/;let j,b,O=!1;const $=a(e=>{let s=null;if(e){const t=u.resolve(e);s={path:t,config:Q(t)}}else{try{s=k()}catch{}if(!s)return}j=z(s),b=B(s),O=s?.config.compilerOptions?.allowJs??!1},"loadTsconfig"),E=a(e=>Array.from(e).length>0?`?${e.toString()}`:"","urlSearchParamsStringify"),D=[".ts",".tsx",".jsx"],F=a((e,...s)=>{for(const t of D)try{return s[0]+=t,e(...s)}catch{}},"tryExtensions"),te=a(e=>(s,...t)=>{try{return e(s,...t)}catch(n){const r=n;if(r.code==="MODULE_NOT_FOUND"){const o=F(e,s,...t)||F(e,`${s}${u.sep}index`,...t);if(o)return o}throw r}},"createImplicitResolver"),ne=`${u.sep}node_modules${u.sep}`,N=a(e=>{if(!e.startsWith("data:text/javascript,"))return;const s=e.indexOf("?");if(s===-1)return;const n=new URLSearchParams(e.slice(s+1)).get("filePath");if(n)return n},"getOriginalFilePath"),A=a(e=>{const s=N(e);return s&&(d._cache[s]=d._cache[e],delete d._cache[e],e=s),e},"interopCjsExports"),y=a((e,s,t)=>{if(!(t?.filename&&L.test(t.filename))&&!O)return;const n=M(s);if(n)for(const r of n)try{return e(r)}catch(o){const{code:c}=o;if(c!=="MODULE_NOT_FOUND"&&c!=="ERR_PACKAGE_PATH_NOT_EXPORTED")throw o}},"resolveTsFilename"),re=a((e,s,t)=>{if(e.startsWith(U)&&(e=T(e)),b&&!R(e)&&!s?.filename?.includes(ne)){const r=b(e);for(const o of r){const c=y(t,o,s);if(c)return c;try{return t(o)}catch{}}}const n=y(t,e,s);if(n)return n;try{return t(e)}catch(r){const o=r;if(o.code==="MODULE_NOT_FOUND"&&typeof o.path=="string"&&o.path.endsWith(`${u.sep}package.json`)){const c=o.message.match(/^Cannot find module '([^']+)'$/);if(c){const p=c[1],f=y(t,p,s);if(f)return f}const i=o.message.match(/^Cannot find module '([^']+)'. Please verify that the package.json has a valid "main" entry$/);if(i){const p=i[1],f=y(t,p,s);if(f)return f}}throw o}},"resolveRequest"),oe=a((e,s)=>(s&&(e=te(e)),(t,n,r,o)=>{const c=a(m=>e(m,n,r,o),"resolve");if(t=A(t),n?.filename){const m=N(n.filename);m&&(n.filename=m.split("?")[0])}const i=t.split("?"),p=new URLSearchParams(i[1]);if(n?.filename){const P=new URLSearchParams(n.filename.split("?")[1]).get("namespace");P&&p.append("namespace",P)}if((p.get("namespace")??void 0)!==s)return c(t);let f=re(i[0],n,c);return u.isAbsolute(f)&&!f.endsWith(".json")&&!f.endsWith(".node")&&(f+=E(p)),f}),"createResolveFilename"),ae=`
//# sourceMappingURL=data:application/json;base64,`,W=a(()=>process.sourceMapsEnabled??!0,"shouldApplySourceMap"),_=a(({code:e,map:s})=>e+ae+Buffer.from(JSON.stringify(s),"utf8").toString("base64"),"inlineSourceMap"),ce=[".cts",".mts",".ts",".tsx",".jsx"],ie=[".js",".cjs",".mjs"],fe=a(e=>{const s=Object.create(Object.getPrototypeOf(e)),t=Object.getOwnPropertyDescriptors(e);for(const n in t)Object.hasOwn(t,n)&&Object.defineProperty(s,n,t[n]);return s},"cloneExtensions"),S=a((e,s,t,n)=>{const r=Object.getOwnPropertyDescriptor(e,s);r?.set?e[s]=t:(!r||r.configurable)&&Object.defineProperty(e,s,{value:t,enumerable:r?.enumerable||n?.enumerable,writable:n?.writable??(r?r.writable:!0),configurable:n?.configurable??(r?r.configurable:!0)})},"safeSet"),le=a((e,s)=>{const t=fe(e),n=t[".js"],r=a((o,c)=>{const[i,p]=c.split("?");if((new URLSearchParams(p).get("namespace")??void 0)!==s)return n(o,i);v?.send&&v.send({type:"dependency",path:i});const m=ce.some(l=>i.endsWith(l)),P=ie.some(l=>i.endsWith(l));if(!m&&!P)return n(o,i);let h=G.readFileSync(i,"utf8");if(i.endsWith(".cjs")){const l=H(c,h);l&&(h=W()?_(l):l.code)}else if(m||X(h)){const l=K(h,c,{tsconfigRaw:j?.(i)});h=W()?_(l):l.code}o._compile(h,i)},"transformer");S(t,".js",r);for(const o of D)S(t,o,r,{enumerable:!s,writable:!0,configurable:!0});return S(t,".mjs",r,{writable:!0,configurable:!0}),t},"createExtensions"),C=a((e,s)=>{if(!s)throw new Error("The current file path (__filename or import.meta.url) must be provided in the second argument of tsx.require()");return(typeof s=="string"&&s.startsWith("file://")||s instanceof URL)&&(s=T(s)),u.resolve(u.dirname(s),e)},"resolveContext"),me=a(e=>{const{sourceMapsEnabled:s}=process,{_extensions:t,_resolveFilename:n}=d;$(process.env.TSX_TSCONFIG_PATH),process.setSourceMapsEnabled(!0);const r=oe(n,e?.namespace);d._resolveFilename=r;const o=le(d._extensions,e?.namespace);d._extensions=o;const c=a(()=>{s===!1&&process.setSourceMapsEnabled(!1),d._extensions=t,d._resolveFilename=n},"unregister");if(e?.namespace){const i=a((f,m)=>{const P=C(f,m),[h,l]=P.split("?"),g=new URLSearchParams(l);return e.namespace&&g.set("namespace",e.namespace),J(h+E(g))},"scopedRequire");c.require=i;const p=a((f,m,P)=>{const h=C(f,m),[l,g]=h.split("?"),w=new URLSearchParams(g);return e.namespace&&w.set("namespace",e.namespace),r(l+E(w),module,!1,P)},"scopedResolve");c.resolve=p,c.unregister=c}return c},"register");export{q as a,_ as b,Z as c,ee as d,se as e,j as f,O as g,U as h,A as i,b as j,$ as l,M as m,me as r,L as t};
